---
title: "P8105_hw2_dxy2101"
author: "Daisy Yan"
date: "2022-10-04"
output: github_document
---

```{r setup, message=FALSE}
library(tidyverse)
library(readxl)
```

# Problem 1

### Load, clean, and use NYC transit dataset

```{r clean, message=FALSE}
subway_data = 
  read_csv(file = '~/Desktop/Data Science I/Homeworks/dxy2101_hw2_P8105/subway.csv') %>%
  janitor::clean_names() %>%
  select(line:entry, vending, ada) %>%
  mutate(
    entry = recode(entry, "YES" = TRUE, "NO" = FALSE)
    )
```

```{r name}
# List variables in dataset
names(subway_data)
```

The NYC transit dataset includes the following variables: line, station name, station latitude, station longitude, route numbers 1-11, entrance type, entry, vending, and ADA compliance.

Thus far, data cleaning has comprised of making all of the variable names the same format, retaining relevant variables, and converting the `entry` variable into a logical variable for future analysis. There are `r nrow(subway_data)` rows and `r ncol(subway_data)` columns.

This data is not tidy.

```{r proportion, echo=FALSE}
# Number of stations without vending that do not allow entrance
x = nrow(
  subway_data %>% 
  filter(vending=='NO', entry==FALSE) %>% 
  distinct(station_name, line)
  )

# Number of stations without vending that do allow entrance
y = nrow(
  subway_data %>% 
  filter(vending=='NO', entry==TRUE) %>% 
  distinct(station_name, line)
  )
```

There are `r nrow(distinct(subway_data, station_name, line))` distinct stations. There are `r nrow(subway_data %>% filter(ada==TRUE) %>% distinct(station_name, line))` stations that are ADA compliant. `r round(y/x, 2)` of the station entrances/exits without vending allow entrance.

```{r reformat}
# Convert all route variables to characters
subway_data =
  subway_data %>%
  mutate(
    route8 = as.character(route8),
    route9 = as.character(route9),
    route10 = as.character(route10),
    route11 = as.character(route11)
  )
  
# Make route number and route name distinct variables
subway_data =
  pivot_longer(
    subway_data,
    route1:route11,
    names_to = "number",
    names_prefix = "route",
    values_to = "name"
  )
```

Now, this data is tidy.

Of the stations that serve the A train, `r nrow(subway_data %>% filter(name=='A', ada==TRUE) %>% distinct(station_name, line))` are ADA compliant.

# Problem 2

### Load, clean, and use Trash Wheel dataset

```{r mr, message=FALSE}
# Read and clean Mr. Trash Wheel dataset
mr_data = 
  read_excel('~/Desktop/Data Science I/Homeworks/dxy2101_hw2_P8105/trash.xlsx', sheet = 1) %>%
  janitor::clean_names() %>%
  select(dumpster:homes_powered) %>%
  na.omit(mr_data) %>%
  mutate(
    sports_balls = as.integer(round(sports_balls, 0))
  )
```

```{r prof}
# Read and clean Professor Trash Wheel dataset
prof_data =
  read_excel('~/Desktop/Data Science I/Homeworks/dxy2101_hw2_P8105/trash.xlsx', sheet = 2) %>%
  janitor::clean_names() %>%
  select(dumpster:homes_powered) %>%
  na.omit(prof_data) %>%
  mutate(
    sports_balls = as.integer(round(sports_balls, 0)),
    dumpster = as.character(dumpster)
  )
```

```{r join, message=FALSE}
# Add column indicating trash collector
mr_data = 
  data.frame(append(mr_data, c(collector="Mr"), after=1))

prof_data =
  data.frame(append(prof_data, c(collector="Professor"), after=1))

# Join data frames
full_df = 
  full_join(mr_data, prof_data)
```

The `full_df` dataset contains data on the number of dumpsters and types of trash collected by both Mr. Trash Wheel and Professor Trash Wheel from 2014 to beginning of 2021. In total, there are `r nrow(full_df)` observations. Key variables include: collector, data collected, weight (tons), types of trash collected and amount collected, and number of homes powered.

```{r weight, echo=FALSE}
prof =
  full_df %>%
  filter(collector=="Professor")
```

The total weight of trash collected by Professor Trash Wheel was `r sum(prof$weight_tons)` tons.

```{r sports, echo=FALSE}
trash = 
  full_df %>%
  filter(collector=="Mr", year == 2020)
```

The total number of sports balls collected by Mr. Trash Wheel in 2020 was `r sum(trash$sports_balls)`.

# Problem 3

### Load, clean, and use FiveThirtyEight datasets

```{r pols-month, message=FALSE}
pols_data = 
  read_csv(file = '~/Desktop/Data Science I/Homeworks/dxy2101_hw2_P8105/fivethirtyeight_datasets/pols-month.csv') %>%
  janitor::clean_names() %>%
  mutate(mon = as.character(mon)) %>%
  separate(col=mon, into=c("year", "month", "day"), sep='-') %>%
  mutate(month = recode(month, "01" = "Jan", "02" = "Feb",
                "03" = "Mar", "04" = "Apr", "05" = "May",
                "06" = "Jun", "07" = "Jul", "08" = "Aug",
                "09" = "Sep", "10" = "Oct", "11" = "Nov",
                "12" = "Dec"))

# Make dataset tidy. Add variable for presidents.
pols_tidy_data = 
  pivot_longer(
    pols_data,
    cols = starts_with("prez"),
    names_to = "president",
    names_prefix = "prez_",
    values_to = "value") %>%
  mutate(
    value = as.numeric(value)
  ) %>%
  select(-value, -day)
```

